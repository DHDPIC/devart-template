<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>devart sphere</title>
		<link type="text/css" rel="stylesheet" href="/css/display.css">
	</head>
	<body>
		<div id="container"></div>

		<p id="orientation">Orientation<br>
	        alpha: <span class="alpha"></span><br>
	        beta: <span class="beta"></span><br>
	        gamma: <span class="gamma"></span>
        </p>
	</body>

	<script type="x-shader/x-vertex" id="textureGenerationVertex">
		varying vec2 vUv;

		void main() {
			vUv = vec2(uv.s, uv.t);
			gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
		}
	</script>

	<script type="x-shader/x-fragment" id="textureGenerationFragment">
		uniform sampler2D tPosition1;
		uniform sampler2D tPosition2;
		uniform float time;
		uniform float delta;

		varying vec2 vUv;

		float rand(vec2 n) {
			return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233))) * 43758.5453);
		}

		void main() {
			vec4 pos1 = texture2D(tPosition1, vUv);
			vec4 pos2 = texture2D(tPosition2, vUv);
			/*vec3 vel;

			float sec = floor(time);
			float ms = floor((time - sec) * 1000.0);

			if(pos2.y < -200.0) {
				pos2.y = 200.0;
				vel.y = 0.0;
			}
			else {
				vel = pos2.xyz - pos1.xyz;
				vel.y = min(vel.y, 0.0);
			}

			vel.y -= rand(vec2(sec, ms)) * 0.1;
			pos2.xyz += vel.xyz;*/

			gl_FragColor = vec4(pos2.xyz, 1.0);
		}
	</script>

	<script type="x-shader/x-vertex" id="vertexshader">
		// switch on high precision floats
		#ifdef GL_ES
		precision highp float;
		#endif

		uniform sampler2D bumpTexture;
		uniform float bumpScale;

		varying float vAmount;
		varying vec2 vUV;

		varying vec3 vNormal;


		void main()
		{
			vNormal = normal;
			vUV = uv;
			vec4 bumpData = texture2D(bumpTexture, uv);

			vAmount = bumpData.r; // get the r channel for height
			vec3 newPosition = position + normal * bumpScale * vAmount;
			gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition,1.0);
		}
	</script>

	<script type="x-shader/x-fragment" id="fragmentshader">
		#ifdef GL_ES
		precision highp float;
		#endif

		varying float vAmount;
		varying vec2 vUV;

		varying vec3 vNormal;

		void main()
		{
			vec3 light = vec3(0.8,0.0,0.8);
			light = normalize(light);
			float dProd = max(0.0, dot(vNormal,light));
			gl_FragColor 	= vec4(dProd/1.0,dProd/5.0,dProd/3.0,1.0);
			//gl_FragColor = vec4(1.0,1.0,1.0,1.0);
		}
	</script>

	<script src="/js/lib/jquery-1.6.1.min.js"></script>
	<script src="/js/lib/three.js"></script>
	<script src="/js/lib/socket.io.js"></script>

	<!-- this file has been intentionally left out of git, it contains ip and port of the node server running index.html
	var config = {
	  server:'<IPADDRESS>',
	  port:'<PORT>'
	};
	-->
	<script src="/js/src/serverconfig.js"></script>

	<script src="/js/src/display.js"></script>
</html>
